<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>添加电影</title>
    <link rel="stylesheet" type="text/css" href="css/movie.css">
</head>
<body>
    <div class="container">
        <h1>添加新电影</h1>
        
        <div class="form-container">
            <form id="movieForm">
                <div class="form-group">
                    <label for="movieTitle">电影标题:</label>
                    <input type="text" id="movieTitle" name="movie_title" required>
                </div>
                
                <div class="form-group">
                    <label for="releaseYear">发布年份:</label>
                    <input type="number" id="releaseYear" name="release_year">
                </div>
                
                <div class="form-group">
                    <label for="region">地区:</label>
                    <input type="text" id="region" name="region">
                </div>
                
                <div class="form-group">
                    <label for="language">语言:</label>
                    <input type="text" id="language" name="language">
                </div>
                
                <div class="form-group">
                    <label for="genre">类型:</label>
                    <input type="text" id="genre" name="genre">
                </div>
                
                <div class="form-group">
                    <label for="plotSummary">剧情简介:</label>
                    <textarea id="plotSummary" name="plot_summary"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="averageRating">平均评分:</label>
                    <input type="number" id="averageRating" name="average_rating" step="0.01">
                </div>
                
                
                <div class="form-group">
                    <label for="posterUrl">海报URL:</label>
                    <input type="text" id="posterUrl" name="poster_url">
                </div>
                
                <button type="submit">添加电影</button>
                <button type="reset">重置表单</button>
            </form>
        </div>
        
        <a href="index.html">返回电影列表</a>
    </div>

    <script>
        // 表单提交事件处理
        document.getElementById('movieForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const movieData = {};
            
            for (let [key, value] of formData.entries()) {
                if (value.trim() !== '') {
                    movieData[key] = value;
                }
            }
            
            fetch('./movies', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(movieData)
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                if (data.status === 'success') {
                    document.getElementById('movieForm').reset();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('添加电影时发生错误');
            });
        });
    </script>
</body>
</html>